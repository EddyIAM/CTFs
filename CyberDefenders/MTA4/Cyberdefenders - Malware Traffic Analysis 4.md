# Challenge Report for Malware Traffic Analysis 4

- **Challenge Name: Malware Traffic Analysis 4**
- **Date: Done before I started documenting.**
- **URL: <https://cyberdefenders.org/labs/57>**
- **Status: Complete**

***

## Description

On the Tuesday before Thanksgiving, Tom and Jake are working at the SOC.  Tom brought his Windows laptop to the office, and he plans to browse the web.  Jake is hard at work reviewing alerts.

Jake's holiday plans are set, and he's happy with the frozen turkey he'd purchased from the supermarket.  Tom's more of a "turkey enthusiast."  He wants to hunt and kill a turkey for his Thanksgiving meal.

To pursue his holiday plans, Tom decides to purchase a shotgun.  He fires up his Windows laptop, connects to the SOC's wifi, and starts researching shotguns online.

It's not long before Tom's computer triggers some alerts for suspicious network activity.  After those alerts, his laptop crashes!

## Tools Used

- BrimSecurity
- NetworkMiner
- WireShark

## Analysis

1. What is the victim IP address?

    **10.1.25.119**

    ```text
    Query in Brim; event_type=="alert" AND alert.severity==1 | cut src_ip, alert.signature | sort src_ip
    Beconing gives it away
    ```

2. What is the victim's hostname?

    **Turkey-Tom**

    ```text
    In wireshark filter for the victims IP Address; ip.src == 10.1.25.119
    You can see NBNS packets with the name
    ```

3. What is the exploit kit name?

    **Angler**

4. What is the IP address that served the exploit?

    **162.216.4.20**

5. What is the HTTP header that is used to indicate the flash version?

    **x-flash-version**

    ```text
    In Brim; event_type=="alert" AND alert.severity==1 then look for teh Outdated Flash Version Alert.
    Open in Wireshark, follow the HTTP conversation"
    ```

6. What is the malicious URL that redirects to the server serving the exploit?

    **<http://solution.babyboomershopping.org/respondents/header.js>**

    ```text
    Since we know the IP address that served the exploit lets see when we went there and the who sent us.
    In Brim; _path=="http" and id.resp_h==162.216.4.20 | cut ts, id.orig_h, id.resp_h, id.resp_p, method,host, referrer, uri | uniq -c | sort referrer
    ```

7. What is The CAPEC ID corresponding to the technique used to redirect the victim to the exploit server? More info at capec.mitre.org

    **CAPEC-222**

    ```text
    <https://capec.mitre.org/data/definitions/222.html>
    ```

8. What is the FQDN of the compromised website?

    **shotgunworld.com**

    ```text
    In Brim; _path=="http" and solution.babyboomershopping.org
    ```

9. The compromised website contains a malicious js that redirect the user to another website. What is the variable name passed to the "document.write" function?

    **OX_7f561e63**

10. What is the Compilation Timestamp of the malware found on the machine? Format: YYYY-MM-DD hh:mm:ss

    **Format: 2007-08-01 18:16:48**

    ```text
    <https://www.virustotal.com/gui/file/d16ad130daed5d4f3a7368ce73b87a8f84404873cbfc90cc77e967a83c947cd2/community>
    ```
