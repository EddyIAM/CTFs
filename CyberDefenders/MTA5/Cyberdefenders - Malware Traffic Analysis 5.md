# Challenge report for Malware Traffic Analysis 5

- **Challenge Name: Malware Traffic Analysis 5**
- **Date: Done before I started documenting.**
- **URL: <https://cyberdefenders.org/labs/58>**
- **Status: Complete**

***

## Description

You're working as an analyst at a Security Operations Center (SOC) for a Thanksgiving-themed company. One quiet evening, you hear someone knocking at the SOC entrance.  As you answer the door, an exhausted mail server technician stumbles in and quickly falls to the floor.  He whispers in a shaky voice, "Mail filters are down...  Spam everywhere..."

## Analysis

1. c41-MTA5-email-01: What is the name of the malicious file?

    **460630672421.exe**

    ```text
    Grab the zip from the email and extract the file
    ```

2. c41-MTA5-email-01: What is the name of the trojan family the malware belongs to? (As identified by emerging threats ruleset).

    **UPATRE**

3. c41-MTA5-email-01: The malware dropped two malicious files with the same hash but with different names. Provide the SHA256 hash of those files? (Check the report submitted in 2015).

    **d1818c3fbbb1f09d8998ad44d14ee9a4fbfae5a1bb58128c2ac077a06d7f84b9**

4. c41-MTA5-email-01: How many DNS requests were initiated by the malware? (Check the report submitted in 2015).

    **3**

5. c41-MTA5-email-02: Multiple streams contain macros in this document. Provide the number of the highest one.

    **20**

6. c41-MTA5-email-02: The Excel macro tried to download a file. Provide the full URL of this file?

    **<http://advancedgroup.net.au/~incantin/334g5j76/897i7uxqe.exe>**

7. c41-MTA5-email-02: What is the name of the object used to get data from the download URL?

    **Microsoft.XMLHTTP**

8. c41-MTA5-email-02: The Excel macro writes a file to the temp folder. Provide the filename?

    **tghtop.exe**

9. c41-MTA5-email-03: Provide the FQDN used by the attacker to store the login credentials?

    **jpmmotos.pt**

10. c41-MTA5-email-04: How many FQDNs are present in the malicious js?

    **3**

11. c41-MTA5-email-04: What is the name of the object used to handle and read files?

    **ADODB.Stream**

12. c41-MTA5.pcap: The victim received multiple emails; however, the user opened a single attachment. Provide the attachment filename.

    **fax000497762.zip**

13. c41-MTA5.pcap: What is the IP address of the victim machine?

    **10.3.66.103**

14. c41-MTA5.pcap: What is the hostname of the victim machine?

    **Strout-PC**

15. c41-MTA5.pcap: What is the FQDN that hosted the malware?

    **kennedy.sitoserver.com**

16. c41-MTA5.pcap: The opened attachment wrote multiple files to the TEMP folder. Provide the name of the first file written to the disk?

    **7997551.exe**

17. c41-MTA5.pcap: One of the written files to the disk has the following md5 hash "35a09d67bee10c6aff48826717680c1c"; Which registry key does this malware check for its existence?

    **9a83a958-b859-11d1-aa90-00aa00ba3258**

18. c41-MTA5.pcap: One of the written files to the disk has the following md5 hash "e2fc96114e61288fc413118327c76d93" sent an HTTP post request to "upload.php" page. Provide the webserver IP. (IP is not in PCAP)

    **78.24.220.229**

19. c41-MTA5.pcap: The malware initiated callback traffic after the infection. Provide the IP of the destination server.

    **109.68.191.31**
